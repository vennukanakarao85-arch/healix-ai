{% extends "base.html" %}
{% block content %}
<div class="sidebar">
    <div class="logo">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
        </svg>
        HEALIX AI
    </div>
    <a href="/dashboard" class="nav-item">Dashboard</a>
    <a href="/history" class="nav-item active">History</a>
    <a href="/settings" class="nav-item">Settings</a>
    <div style="flex:1"></div>
    <a href="/login" class="nav-item">Sign Out</a>
</div>

<div class="main-content">
    <div class="header">
        <h2>Health History</h2>
        <div style="display:flex; gap:10px; align-items:center;">
            <span style="color:var(--text-muted);">{{ username }}</span>
            <div
                style="width:32px; height:32px; background:#334155; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#94A3B8;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </div>
        </div>
    </div>

    <style>
        .history-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            color: var(--text-main);
        }

        .history-table th,
        .history-table td {
            text-align: left;
            padding: 16px;
            border-bottom: 1px solid #374151;
        }

        .history-table th {
            background: #111827;
            color: var(--text-muted);
            font-weight: 600;
        }

        .history-table tr:hover {
            background: rgba(59, 130, 246, 0.05);
        }
    </style>

    <table class="history-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Symptoms/Input</th>
                <th>Diabetes Risk</th>
                <th>Heart Risk</th>
                <th>Kidney Risk</th>
            </tr>
        </thead>
        <tbody>
            {% for record in records %}
            <tr>
                <td>{{ record.created_at }}</td>
                <td>{{ record.symptoms[:50] }}{% if record.symptoms|length > 50 %}...{% endif %}</td>
                <td style="color:var(--risk-diabetes);">{{ record.diabetes|round|int }}%</td>
                <td style="color:var(--risk-heart);">{{ record.heart|round|int }}%</td>
                <td style="color:var(--risk-kidney);">{{ record.kidney|round|int }}%</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" style="text-align:center; color:var(--text-muted);">No records found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}